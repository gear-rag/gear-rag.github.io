<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners -->
  <meta name="description" content="GeAR: Graph-enhanced Agent for Retrieval-augmented Generation">
  <meta property="og:title" content="GeAR: Graph-enhanced Agent for Retrieval-augmented Generation"/>
  <meta property="og:description" content="A novel framework that incorporates a graph-based retriever within a multi-step retrieval agent for multi-hop question answering"/>
  <meta property="og:url" content="https://gear-rag.github.io/"/>
  <meta property="og:image" content="static/image/red-gear.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <meta name="twitter:title" content="GeAR: Graph-enhanced Agent for RAG">
  <meta name="twitter:description" content="A graph-enhanced framework for retrieval-augmented generation achieving SOTA on multi-hop QA">
  <meta name="twitter:image" content="static/image/gears.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="retrieval augmented generation, RAG, multi-hop question answering, graph-based retrieval, large language models">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>GeAR</title>
  <link rel="icon" type="image/png" href="static/images/red-gear.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">GeAR: Graph-enhanced Agent for Retrieval-augmented Generation</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=Fdlwl5QAAAAJ&hl=en" target="_blank">Zhili Shen</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=WAVUdOYAAAAJ&hl=en" target="_blank">Chenxin Diao</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=9J7YeR0AAAAJ&hl=en" target="_blank">Pavlos Vougiouklis</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://pascualmeritatorres.github.io/" target="_blank">Pascual Merita</a><sup>†</sup>,
              </span><br>
              <span class="author-block">
                <a href="https://arxiv.org/search/?searchtype=author&query=Shriram%20Piramanayagam" target="_blank">Shriram Piramanayagam</a>,
              </span>
              <span class="author-block">
                <a href="https://dgraux.github.io/" target="_blank">Damien Graux</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=nf8bdFYAAAAJ&hl=zh-CN" target="_blank">Dandan Tu</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com.hk/citations?user=Ji76oogAAAAJ&hl=zh-CN" target="_blank">Zeren Jiang</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=_V1aEUcAAAAJ&hl=zh-CN" target="_blank">Ruofei Lai</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.ca/citations?user=BDTV6PQAAAAJ&hl=en" target="_blank">Yang Ren</a>,
              </span>
              <span class="author-block">
                <a href="https://knowledge-representation.org/j.z.pan/" target="_blank">Jeff Z. Pan</a>,
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <span>Huawei Technologies Co., Ltd., Edinburgh, United Kingdom</span><br>Submitted to ACL 2025
              </span>
              <span class="eql-cntrb"><small><br><sup>†</sup>Equal Contribution</small></span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- Arxiv link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2412.18431" target="_blank" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv" style="color: #B31B1B;"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>

                <!-- PDF Link -->
                <span class="link-block">
                  <a href="static/pdfs/gear-pdf.pdf" target="_blank" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>PDF</span>
                  </a>
                </span>

                <!-- Code Snippets Link -->
                <span class="link-block">
                  <a href="#code-snippets" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-code"></i>
                    </span>
                    <span>Code Snippets</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Key Innovations Section -->
  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column">
          <h2 class="title is-3 has-text-centered">Key Innovations</h2>
          <div class="content">
            <div class="columns">
              <div class="column">
                <div class="innovation-card">
                  <div class="innovation-icon">
                    <i class="fas fa-project-diagram"></i>
                  </div>
                  <h3 class="title is-5">Graph Expansion</h3>
                  <p>Enhances any base retriever (i.e BM25) by discovering multi-hop connections in a single step</p>
                </div>
              </div>
              <div class="column">
                <div class="innovation-card">
                  <div class="innovation-icon">
                    <i class="fas fa-brain"></i>
                  </div>
                  <h3 class="title is-5">Gist Memory</h3>
                  <p>Maintains important context across retrieval steps, simulating the working memory in humans</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- How it Works section -->
  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column">
          <h2 class="title is-3">How it Works</h2>
          <div class="content has-text-justified">
            <p>
              GeAR starts by employing a base retriever (like BM25) to fetch passages. Then, it employs a novel graph expansion technique which we call SyncGE to discover multi-hop content. During graph expansion, GeAR starts by using a language model to extract important information from the retrieved passages. We represent such important information in the form of triples, and use those triples to start exploring the graph. This helps bridge passages that may be several reasoning steps (or hops) apart. With these new passages, we use a language model to maintain a "gist memory" that accumulates key information across multiple retrieval steps, similar to how the human brain's hippocampus stores important memories. We then reason with such gist memory do determine whether we need additional information. If we do, we determine the next query to search for, and if we don’t we merge the information in the gist memory with the other retrieved passages, and return the combination of both.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Results Section -->
  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column">
          <h2 class="title is-3 has-text-centered">Results</h2>
          <div class="content">
            <div class="columns">
              <div class="column">
                <div class="innovation-card">
                  <div class="innovation-icon">
                    <i class="fas fa-medal"></i>
                  </div>
                  <h3 class="title is-5">Higher Performance</h3>
                  <p>State-of-the-art Retrieval and QA Performance across challenging multi-hop datasets</p>
                </div>
              </div>
              <div class="column">
                <div class="innovation-card">
                  <div class="innovation-icon">
                    <i class="fas fa-tachometer-alt"></i>
                  </div>
                  <h3 class="title is-5">Efficient Retrieval</h3>
                  <p>Solves multi-hop problems using fewer tokens than previous approaches</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

<!-- Real-World Example Section -->
<section class="section hero">
  <div class="container is-max-desktop">
    <h2 class="title is-3 has-text-centered">Example: Multi-Hop Question</h2>
    <div class="example-container">
      <!-- Original Question -->
      <div class="example-step initial-question">
        <div class="example-header question">
          <i class="fas fa-question-circle"></i>
          Original Question
        </div>
        <div class="example-content">
          "Where did the British-Canadian researcher that got awarded the 2024 Nobel Prize in Physics study his PhD?"
        </div>
      </div>

      <!-- Iteration 1 -->
      <div class="iteration-container expanded">
        <div class="iteration-header collapsible">
          <span class="iteration-title">Iteration 1</span>
          <button class="collapse-btn">
            <i class="fas fa-chevron-up"></i>
          </button>
        </div>
        
        <div class="iteration-content">
          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-search"></i>
              Step 1: Initial Retrieval (BM25)
            </div>
            <div class="example-content">
              Finds documents about:<br>
              - 2024 Nobel Prize in Physics<br>
              - Notable physics researchers<br>
              - British/Canadian academic institutions
            </div>
          </div>

          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-expand-arrows-alt"></i>
              Step 2: Graph Expansion
            </div>
            <div class="example-content">
              Discovers connections:<br>
              • (Geoffrey Hinton → awarded → 2024 Nobel Physics Prize)<br>
              • (Geoffrey Hinton → nationality → British-Canadian)<br>
              • (Nobel Prize → category → Physics)
            </div>
          </div>

          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-brain"></i>
              Step 3: Reason & Rewrite
            </div>
            <div class="example-content">
              <strong>Gist Memory:</strong> Identified Geoffrey Hinton as target researcher<br>
              <strong>Missing Info:</strong> PhD institution not in retrieved documents<br>
              <strong>New Query:</strong> "Geoffrey Hinton PhD education"
            </div>
          </div>
        </div>
      </div>

      <!-- Iteration 2 -->
      <div class="iteration-container expanded">
        <div class="iteration-header collapsible">
          <span class="iteration-title">Iteration 2</span>
          <button class="collapse-btn">
            <i class="fas fa-chevron-up"></i>
          </button>
        </div>
        
        <div class="iteration-content">
          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-search"></i>
              Step 4: Second Retrieval
            </div>
            <div class="example-content">
              Finds documents about:<br>
              - Geoffrey Hinton biography<br>
              - University alumni records<br>
              - Machine learning pioneers
            </div>
          </div>

          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-expand-arrows-alt"></i>
              Step 5: Graph Expansion
            </div>
            <div class="example-content">
              Expands connections:<br>
              • (Geoffrey Hinton → PhD → University of Edinburgh)<br>
              • (University of Edinburgh → department → AI)<br>
              • (Hinton's PhD → supervisor → Christopher Longuet-Higgins)
            </div>
          </div>

          <div class="example-step">
            <div class="example-header">
              <i class="fas fa-check-circle"></i>
              Step 6: Final Verification
            </div>
            <div class="example-content">
              <strong>Gist Memory:</strong> PhD institution found in university records<br>
              <strong>Evidence:</strong> Multiple sources confirm Edinburgh affiliation<br>
              <strong>Confidence:</strong> 98.7% (cross-verified with 3 sources)
            </div>
          </div>
        </div>
      </div>

      <!-- Final Answer -->
      <div class="example-step final-answer">
        <div class="example-header answer">
          <i class="fas fa-check-double"></i>
          Answer
        </div>
        <div class="example-content">
          "Geoffrey Hinton, the British-Canadian researcher awarded the 2024 Nobel Prize in Physics, completed his PhD at the University of Edinburgh under Christopher Longuet-Higgins."
        </div>
      </div>
    </div>
  </div>
</section>

  
<!-- Code Example section -->
<section class="section hero is-light" id="code-snippets">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column">
            <h2 class="title is-3 has-text-centered">Pseudocode</h2>
            <div class="content has-text-justified">
              <p>
                Below we present pseudocode for both diverse triple beam search (used for graph expansion), and the full GeAR pipeline. Please note that although the code is presented in a python-esque way, it is still pseudocode.
              </p>
            </div>
          <div class="code-window">
            <div class="code-window-header">
              <div class="window-controls">
                <div class="window-control control-red"></div>
                <div class="window-control control-yellow"></div>
                <div class="window-control control-green"></div>
              </div>
              <div class="tab-container">
                <div class="tab active" data-tab="gear">
                  <img src="static/images/python_logo.png" alt="Python Logo" class="tab-icon" />
                  <span>GeAR.py</span>
                  <span class="close-icon">×</span> <!-- Add this line -->
                </div>
                <div class="tab" data-tab="syncge">
                  <img src="static/images/python_logo.png" alt="Python Logo" class="tab-icon" />
                  <span>SyncGE.py</span>
                  <span class="close-icon">×</span> <!-- Add this line -->
                </div>
                <div class="tab" data-tab="diverse">
                  <img src="static/images/python_logo.png" alt="Python Logo" class="tab-icon" />
                  <span>diverse_triple_beam_search.py</span>
                  <span class="close-icon">×</span> <!-- Add this line -->
                </div>
              </div>
            </div>
            <div class="code-content-container">
<div class="code-content active" id="gear-content">
<pre><code><span class="code-keyword">class</span> <span class="code-class">GistMemory</span><span class="code-colon">:</span>
    <span class="code-docstring">"""
    Manages the accumulation and storage of proximal triples
    across multiple retrieval steps.
    """</span>
    <span class="code-keyword">def</span> <span class="code-function">__init__</span><span class="code-brackets">(</span><span class="code-variable">self</span><span class="code-brackets">)</span><span class="code-colon">:</span>
        <span class="code-variable">self</span><span class="code-punctuation">.</span><span class="code-variable">proximal_triples</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>
    
    <span class="code-keyword">def</span> <span class="code-function">add_triples</span><span class="code-brackets">(</span><span class="code-variable">self</span><span class="code-punctuation">,</span> <span class="code-variable">new_triples</span><span class="code-brackets">)</span><span class="code-colon">:</span>
        <span class="code-docstring">"""Append new proximal triples to memory"""</span>
        <span class="code-variable">self</span><span class="code-punctuation">.</span><span class="code-variable">proximal_triples</span><span class="code-punctuation">.</span><span class="code-method">extend</span><span class="code-brackets">(</span><span class="code-variable">new_triples</span><span class="code-brackets">)</span>
    
    <span class="code-keyword">def</span> <span class="code-function">get_all_triples</span><span class="code-brackets">(</span><span class="code-variable">self</span><span class="code-brackets">)</span><span class="code-colon">:</span>
        <span class="code-docstring">"""Return all accumulated triples"""</span>
        <span class="code-keyword">return</span> <span class="code-variable">self</span><span class="code-punctuation">.</span><span class="code-variable">proximal_triples</span>

<span class="code-keyword">def</span> <span class="code-function">GeAR</span><span class="code-brackets">(</span><span class="code-variable">query</span><span class="code-punctuation">,</span> <span class="code-variable">max_steps</span><span class="code-operator">=</span><span class="code-number">4</span><span class="code-brackets">)</span><span class="code-colon">:</span>
    <span class="code-docstring">"""
    GeAR pipeline implementation with multi-step retrieval capabilities.
    
    Parameters:
        query: Original input query  
        max_steps: Maximum number of retrieval steps
    """</span>
    <span class="code-comment"># Initialize variables</span>
    <span class="code-variable">gist_memory</span> <span class="code-operator">=</span> <span class="code-method">GistMemory</span><span class="code-brackets">()</span>
    <span class="code-variable">current_query</span> <span class="code-operator">=</span> <span class="code-variable">query</span>
    <span class="code-variable">step</span> <span class="code-operator">=</span> <span class="code-number">1</span>
    <span class="code-variable">retrieved_passages</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>
    
    <span class="code-keyword">while</span> <span class="code-variable">step</span> <span class="code-operator"><=</span> <span class="code-variable">max_steps</span><span class="code-colon">:</span>
        <span class="code-comment"># Base retrieval for current query (i.e bm25)</span>
        <span class="code-variable">base_passages</span> <span class="code-operator">=</span> <span class="code-method">base_retriever</span><span class="code-brackets">(</span><span class="code-variable">current_query</span><span class="code-brackets">)</span>
        
        <span class="code-comment"># Read passages and extract proximal triples via LLM</span>
        <span class="code-keyword">if</span> <span class="code-variable">step</span> <span class="code-operator">==</span> <span class="code-number">1</span><span class="code-colon">:</span>
            <span class="code-variable">proximal_triples</span> <span class="code-operator">=</span> <span class="code-method">reader</span><span class="code-brackets">(</span><span class="code-variable">base_passages</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-brackets">)</span>
        <span class="code-keyword">else</span><span class="code-colon">:</span>
            <span class="code-variable">proximal_triples</span> <span class="code-operator">=</span> <span class="code-method">reader</span><span class="code-brackets">(</span><span class="code-variable">base_passages</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-punctuation">,</span> <span class="code-variable">gist_memory</span><span class="code-punctuation">.</span><span class="code-method">get_all_triples</span><span class="code-brackets">()</span><span class="code-brackets">)</span>
        
        <span class="code-comment"># Link proximal triples to their closest real triples in index</span>
        <span class="code-variable">triples</span> <span class="code-operator">=</span> <span class="code-method">tripleLink</span><span class="code-brackets">(</span><span class="code-variable">proximal_triples</span><span class="code-brackets">)</span>

        <span class="code-comment"># Graph expansion using proximal triples</span>
        <span class="code-variable">expanded_passages</span> <span class="code-operator">=</span> <span class="code-method">graph_expasion</span><span class="code-brackets">(</span><span class="code-variable">triples</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-brackets">)</span>

        <span class="code-comment"># Combine base and expanded passages, and save them</span>
        <span class="code-variable">combined_passages</span> <span class="code-operator">=</span> <span class="code-method">rrf</span><span class="code-brackets">(</span><span class="code-variable">base_passages</span> <span class="code-operator">+</span> <span class="code-variable">expanded_passages</span><span class="code-brackets">)</span>
        <span class="code-variable">retrieved_passages</span><span class="code-punctuation">.</span><span class="code-method">append</span><span class="code-brackets">(</span><span class="code-variable">combined_passages</span><span class="code-brackets">)</span>
        
        <span class="code-comment"># Read passages and extract proximal triples via LLM </span>
        <span class="code-variable">proximal_triples</span> <span class="code-operator">=</span> <span class="code-method">gist_memory_constructor</span><span class="code-brackets">(</span><span class="code-variable">expanded_passages</span><span class="code-brackets">)</span>

        <span class="code-comment"># Add to gist memory</span>
        <span class="code-variable">gist_memory</span><span class="code-punctuation">.</span><span class="code-method">add_triples</span><span class="code-brackets">(</span><span class="code-variable">proximal_triples</span><span class="code-brackets">)</span>

        <span class="code-comment"># Check if we have enough evidence to answer query</span>
        <span class="code-variable">is_answerable</span><span class="code-punctuation">,</span> <span class="code-variable">reasoning</span> <span class="code-operator">=</span> <span class="code-method">reason</span><span class="code-brackets">(</span><span class="code-variable">gist_memory</span><span class="code-punctuation">.</span><span class="code-method">get_all_triples</span><span class="code-brackets">()</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-brackets">)</span>
        
        <span class="code-keyword">if</span> <span class="code-variable">is_answerable</span><span class="code-colon">:</span>
            <span class="code-keyword">break</span>
        <span class="code-keyword">else</span><span class="code-colon">:</span>
            <span class="code-comment"># Rewrite query for next step</span>
            <span class="code-variable">current_query</span> <span class="code-operator">=</span> <span class="code-method">rewrite</span><span class="code-brackets">(</span><span class="code-variable">query</span><span class="code-punctuation">,</span> <span class="code-variable">gist_memory</span><span class="code-punctuation">.</span><span class="code-method">get_all_triples</span><span class="code-brackets">()</span><span class="code-punctuation">,</span> <span class="code-variable">reasoning</span><span class="code-brackets">)</span>
            <span class="code-variable">step</span> <span class="code-operator">+=</span> <span class="code-number">1</span>
    
    <span class="code-comment"># Link final gist memory triples to passages</span>
    <span class="code-variable">gist_passages</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>
    <span class="code-keyword">for</span> <span class="code-variable">triple</span> <span class="code-keyword">in</span> <span class="code-variable">gist_memory</span><span class="code-punctuation">.</span><span class="code-method">get_all_triples</span><span class="code-brackets">()</span><span class="code-colon">:</span>
        <span class="code-variable">linked_passages</span> <span class="code-operator">=</span> <span class="code-method">passageLink</span><span class="code-brackets">(</span><span class="code-variable">triple</span><span class="code-brackets">)</span>
        <span class="code-variable">gist_passages</span><span class="code-punctuation">.</span><span class="code-method">append</span><span class="code-brackets">(</span><span class="code-variable">linked_passages</span><span class="code-brackets">)</span>
    
    <span class="code-comment"># Final passage ranking combining all retrieved passages</span>
    <span class="code-variable">final_passages</span> <span class="code-operator">=</span> <span class="code-method">rrf</span><span class="code-brackets">(</span><span class="code-variable">gist_passages</span> <span class="code-operator">+</span> <span class="code-variable">retrieved_passages</span><span class="code-brackets">)</span>

    <span class="code-keyword">return</span> <span class="code-variable">final_passages</span></code></pre>
</div>
<div class="code-content" id="syncge-content">
  <pre><code><span class="code-keyword">def</span> <span class="code-function">SyncGE</span><span class="code-brackets">(</span><span class="code-variable">query</span><span class="code-brackets">)</span><span class="code-colon">:</span>
    <span class="code-docstring">"""
    SyncGE pipeline implementation.
    
    Parameters:
        query: Input query  
    """</span>
    
    <span class="code-comment"># Base retrieval for current query (i.e bm25)</span>
    <span class="code-variable">base_passages</span> <span class="code-operator">=</span> <span class="code-method">base_retriever</span><span class="code-brackets">(</span><span class="code-variable">current_query</span><span class="code-brackets">)</span>
    
    <span class="code-comment"># Read passages and extract proximal triples via LLM</span>
    <span class="code-variable">proximal_triples</span> <span class="code-operator">=</span> <span class="code-method">reader</span><span class="code-brackets">(</span><span class="code-variable">base_passages</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-brackets">)</span>
    
    <span class="code-comment"># Link proximal triples to their closest real triples in index</span>
    <span class="code-variable">triples</span> <span class="code-operator">=</span> <span class="code-method">tripleLink</span><span class="code-brackets">(</span><span class="code-variable">proximal_triples</span><span class="code-brackets">)</span>

    <span class="code-comment"># Graph expansion using proximal triples</span>
    <span class="code-variable">expanded_passages</span> <span class="code-operator">=</span> <span class="code-method">graph_expasion</span><span class="code-brackets">(</span><span class="code-variable">triples</span><span class="code-punctuation">,</span> <span class="code-variable">query</span><span class="code-brackets">)</span>

    <span class="code-comment"># Combine base and expanded passages, and save them</span>
    <span class="code-variable">combined_passages</span> <span class="code-operator">=</span> <span class="code-method">rrf</span><span class="code-brackets">(</span><span class="code-variable">base_passages</span> <span class="code-operator">+</span> <span class="code-variable">expanded_passages</span><span class="code-brackets">)</span>

    <span class="code-keyword">return</span> <span class="code-variable">combined_passages</span></code></pre>
</div>
              <div class="code-content" id="diverse-content">
                <pre><code><span class="code-keyword">def</span> <span class="code-function">diverse_triple_search</span><span class="code-brackets">(</span><span class="code-variable">q</span><span class="code-punctuation">,</span> <span class="code-variable">t_list</span><span class="code-punctuation">,</span> <span class="code-variable">b</span><span class="code-punctuation">,</span> <span class="code-variable">l</span><span class="code-punctuation">,</span> <span class="code-variable">γ</span><span class="code-brackets">)</span><span class="code-colon">:</span>
    <span class="code-docstring">"""
    Performs diverse triple beam search, used in our proposed NaiveGE or SyncGE.

    Parameters:
        q: query
        b: beam size
        t_list: initial triples  
        l: maximum length
        γ: hyperparameter for diversity
    """</span>
    <span class="code-comment"># Initialize beam for first step</span>
    <span class="code-variable">B_0</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>

    <span class="code-comment"># Score individual triples</span>
    <span class="code-keyword">for</span> <span class="code-variable">t</span> <span class="code-keyword">in</span> <span class="code-variable">t_list</span><span class="code-colon">:</span>
        <span class="code-variable">s</span> <span class="code-operator">=</span> <span class="code-method">score</span><span class="code-brackets">(</span><span class="code-variable">q</span>, <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span><span class="code-brackets">)</span>
        <span class="code-variable">B_0</span><span class="code-punctuation">.</span><span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s</span><span class="code-punctuation">,</span> <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
    
    <span class="code-variable">B_0</span> <span class="code-operator">=</span> <span class="code-method">top</span><span class="code-brackets">(</span><span class="code-variable">B_0</span>, <span class="code-variable">b</span><span class="code-brackets">)</span>  <span class="code-comment"># Keep top b scoring triples</span>
    
    <span class="code-comment"># Iterative beam search</span>
    <span class="code-keyword">for</span> <span class="code-variable">i</span> <span class="code-keyword">in</span> <span class="code-builtin">range</span><span class="code-brackets">(</span><span class="code-number">1</span>, <span class="code-variable">l</span><span class="code-brackets">)</span><span class="code-colon">:</span>
        <span class="code-variable">B</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>
        
        <span class="code-keyword">for</span> <span class="code-brackets">(</span><span class="code-variable">s</span>, <span class="code-variable">T</span><span class="code-brackets">)</span> <span class="code-keyword">in</span> <span class="code-variable">B_{i-1}</span><span class="code-colon">:</span>
            <span class="code-variable">V</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>  <span class="code-comment"># Candidates from current path</span>
            
            <span class="code-comment"># Explore neighboring triples</span>
            <span class="code-keyword">for</span> <span class="code-variable">t</span> <span class="code-keyword">in</span> <span class="code-method">get_neighbours</span><span class="code-brackets">(</span><span class="code-variable">T</span><span class="code-brackets">[</span>-<span class="code-number">1</span><span class="code-brackets">]</span><span class="code-brackets">)</span><span class="code-colon">:</span>
                <span class="code-comment"># Skip if triple already used</span>
                <span class="code-keyword">if</span> <span class="code-method">exists</span><span class="code-brackets">(</span><span class="code-variable">t</span><span class="code-punctuation">,</span> <span class="code-variable">B_{i-1}</span><span class="code-brackets">)</span><span class="code-colon">:</span>
                    <span class="code-keyword">continue</span>
                
                <span class="code-comment"># Score new path with concatenated triple</span>
                <span class="code-variable">new_path</span> <span class="code-operator">=</span> <span class="code-variable">T</span> <span class="code-operator">+</span> <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span>
                <span class="code-variable">s_new</span> <span class="code-operator">=</span> <span class="code-variable">s</span> <span class="code-operator">+</span> <span class="code-method">score</span><span class="code-brackets">(</span><span class="code-variable">q</span><span class="code-punctuation">,</span> <span class="code-variable">new_path</span><span class="code-brackets">)</span>
                <span class="code-variable">V</span>.<span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s_new</span>, <span class="code-variable">new_path</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
            
            <span class="code-method">sort</span><span class="code-brackets">(</span><span class="code-variable">V</span><span class="code-punctuation">,</span> <span class="code-variable">descending</span><span class="code-operator">=</span><span class="code-builtin">True</span><span class="code-brackets">)</span>
            
            <span class="code-comment"># Apply diversity penalty</span>
            <span class="code-keyword">for</span> <span class="code-variable">n</span> <span class="code-keyword">in</span> <span class="code-builtin">range</span><span class="code-brackets">(</span><span class="code-method">len</span><span class="code-brackets">(</span><span class="code-variable">V</span><span class="code-brackets">)</span><span class="code-brackets">)</span><span class="code-colon">:</span>
                <span class="code-variable">s_new</span><span class="code-punctuation">,</span> <span class="code-variable">path</span> <span class="code-operator">=</span> <span class="code-variable">V</span><span class="code-brackets">[</span><span class="code-variable">n</span><span class="code-brackets">]</span>
                <span class="code-variable">penalty</span> <span class="code-operator">=</span> <span class="code-builtin">exp</span><span class="code-brackets">(</span><span class="code-operator">-</span><span class="code-builtin">min</span><span class="code-brackets">(</span><span class="code-variable">n</span>, <span class="code-variable">γ</span><span class="code-brackets">)</span><span class="code-operator">/</span><span class="code-variable">γ</span><span class="code-brackets">)</span>
                <span class="code-variable">B</span><span class="code-punctuation">.</span><span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s_new</span> <span class="code-operator">*</span> <span class="code-variable">penalty</span><span class="code-punctuation">,</span> <span class="code-variable">path</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
        
        <span class="code-variable">B_i</span> <span class="code-operator">=</span> <span class="code-method">top</span><span class="code-brackets">(</span><span class="code-variable">B</span>, <span class="code-variable">b</span><span class="code-brackets">)</span>  <span class="code-comment"># Keep top b paths</span>
    
    <span class="code-keyword">return</span> <span class="code-variable">B_i</span></code></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Retrieval Results Section -->
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column">
        <h2 class="title is-3 has-text-centered">Retrieval Results</h2>
        <div class="content has-text-centered">
          <p>GeAR achieves state-of-the-art retrieval performance across multiple multi-hop QA benchmarks</p>
          <figure class="image is-16by9" style="margin: 0rem 0;">
            <img src="static/images/retrieval_results.png" alt="Retrieval Results Comparison">
          </figure>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- QA Results Section -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column">
        <h2 class="title is-3 has-text-centered">Question-Answering Results</h2>
        <div class="content has-text-centered">
          <p>GeAR achieves state-of-the-art retrieval performance across multiple multi-hop QA benchmarks</p>
          <!-- Remove inline style from figure -->
          <div class="qa-results-container">
            <figure class="image">
              <img src="static/images/qa_results.png" alt="QA Results Comparison">
            </figure>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Call to Action Section -->
<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column has-text-centered">
        <a href="https://arxiv.org/abs/2412.18431" target="_blank" class="button is-large cta-button">
          <span class="icon">
            <i class="ai ai-arxiv"></i>
          </span>
          <span>Read our paper</span>
        </a>
      </div>
    </div>
  </div>
</section>





  <!--BibTeX citation -->
  <section class="section hero is-light" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{shen2024gear,
  title={GeAR: Graph-enhanced Agent for Retrieval-augmented Generation},
  author={Shen, Zhili and Diao, Chenxin and Vougiouklis, Pavlos and Merita, Pascual and Piramanayagam, Shriram and Graux, Damien and Tu, Dandan and Jiang, Zeren and Lai, Ruofei and Ren, Yang and Pan, Jeff Z.},
  journal={arXiv preprint arXiv:2412.18431},
  year={2024}
}</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
              You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
              Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>


<script>
  document.addEventListener('DOMContentLoaded', function() {
    const collapsibles = document.querySelectorAll('.collapsible');
    
    collapsibles.forEach(header => {
      header.addEventListener('click', function() {
        const container = this.closest('.iteration-container');
        container.classList.toggle('expanded');
        
        const button = this.querySelector('.collapse-btn i');
        button.classList.toggle('fa-chevron-down');
        button.classList.toggle('fa-chevron-up');
      });
    });
  });
  </script>

</body>
</html>