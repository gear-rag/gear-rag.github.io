<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners -->
  <meta name="description" content="GeAR: Graph-enhanced Agent for Retrieval-augmented Generation">
  <meta property="og:title" content="GeAR: Graph-enhanced Agent for Retrieval-augmented Generation"/>
  <meta property="og:description" content="A novel framework that incorporates a graph-based retriever within a multi-step retrieval agent for multi-hop question answering"/>
  <meta property="og:url" content="https://gear-rag.github.io/"/>
  <meta property="og:image" content="static/image/red-gear.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <meta name="twitter:title" content="GeAR: Graph-enhanced Agent for RAG">
  <meta name="twitter:description" content="A graph-enhanced framework for retrieval-augmented generation achieving SOTA on multi-hop QA">
  <meta name="twitter:image" content="static/image/gears.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="retrieval augmented generation, RAG, multi-hop question answering, graph-based retrieval, large language models">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>GeAR</title>
  <link rel="icon" type="image/png" href="static/images/red-gear.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">GeAR: Graph-enhanced Agent for Retrieval-augmented Generation</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=Fdlwl5QAAAAJ&hl=en" target="_blank">Zhili Shen</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=WAVUdOYAAAAJ&hl=en" target="_blank">Chenxin Diao</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=9J7YeR0AAAAJ&hl=en" target="_blank">Pavlos Vougiouklis</a><sup>†</sup>,
              </span>
              <span class="author-block">
                <a href="https://pascualmeritatorres.github.io/" target="_blank">Pascual Merita</a><sup>†</sup>,
              </span><br>
              <span class="author-block">
                <a href="https://arxiv.org/search/?searchtype=author&query=Shriram%20Piramanayagam" target="_blank">Shriram Piramanayagam</a>,
              </span>
              <span class="author-block">
                <a href="https://dgraux.github.io/" target="_blank">Damien Graux</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=nf8bdFYAAAAJ&hl=zh-CN" target="_blank">Dandan Tu</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com.hk/citations?user=Ji76oogAAAAJ&hl=zh-CN" target="_blank">Zeren Jiang</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=_V1aEUcAAAAJ&hl=zh-CN" target="_blank">Ruofei Lai</a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.ca/citations?user=BDTV6PQAAAAJ&hl=en" target="_blank">Yang Ren</a>,
              </span>
              <span class="author-block">
                <a href="https://knowledge-representation.org/j.z.pan/" target="_blank">Jeff Z. Pan</a>,
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <span>Huawei Technologies Co., Ltd., Edinburgh, United Kingdom</span><br>Submitted to ACL 2025
              </span>
              <span class="eql-cntrb"><small><br><sup>†</sup>Equal Contribution</small></span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- Arxiv link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2412.18431" target="_blank" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv" style="color: #B31B1B;"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>

                <!-- PDF Link -->
                <span class="link-block">
                  <a href="static/pdfs/gear-pdf.pdf" target="_blank" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>PDF</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Paper abstract -->
  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Retrieval-augmented generation systems rely on effective document retrieval capabilities. By design, conventional sparse or dense retrievers face challenges in multi-hop retrieval scenarios. In this paper, we present GeAR, which advances RAG performance through two key innovations: (i) graph expansion, which enhances any conventional base retriever, such as BM25, and (ii) an agent framework that incorporates graph expansion. Our evaluation demonstrates GeAR's superior retrieval performance on three multi-hop question answering datasets. Additionally, our system achieves state-of-the-art results with improvements exceeding 10% on the challenging MuSiQue dataset, while requiring fewer tokens and iterations compared to other multi-step retrieval systems.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- How it Works section -->
  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">How it Works</h2>
          <div class="content has-text-justified">
            <p>
              GeAR works by combining any retriever with a LLM agent to tackle complex multi-hop questions. The system first uses a base retriever (like BM25) to fetch initial passages, then employs a novel graph expansion technique called SyncGE to discover related content. During graph expansion, GeAR uses a language model to identify important information triples from the retrieved passages, then explores connections between these triples using diverse beam search. This helps bridge passages that may be several reasoning steps apart. The system maintains a "gist memory" that accumulates key information across multiple retrieval steps, similar to how the human brain's hippocampus processes memories. This approach allows GeAR to build comprehensive reasoning chains while using fewer computational resources than previous methods. The result is a more efficient system that achieves state-of-the-art performance on challenging multi-hop question answering tasks.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Code Example section -->
  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-four-fifths">
          <div class="code-window">
            <div class="code-window-header">
              <div class="window-controls">
                <div class="window-control control-red"></div>
                <div class="window-control control-yellow"></div>
                <div class="window-control control-green"></div>
              </div>
              <span class="code-window-title">diverse_triple_search.pseudocode</span>
            </div>
            <div class="code-content">
                <pre><code><span class="code-keyword">def</span> <span class="code-function">diverse_triple_search</span><span class="code-brackets">(</span><span class="code-variable">q</span><span class="code-punctuation">,</span> <span class="code-variable">t_list</span><span class="code-punctuation">,</span> <span class="code-variable">b</span><span class="code-punctuation">,</span> <span class="code-variable">l</span><span class="code-punctuation">,</span> <span class="code-variable">γ</span><span class="code-brackets">)</span><span class="code-colon">:</span>
    <span class="code-docstring">"""
    Performs diverse triple beam search, used in our proposed NaiveGE or SyncGE.

    Parameters:
        q: query
        b: beam size
        t_list: initial triples  
        l: maximum length
        γ: hyperparameter for diversity
    """</span>
    <span class="code-comment"># Initialize beam for first step</span>
    <span class="code-variable">B_0</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>

    <span class="code-comment"># Score individual triples</span>
    <span class="code-keyword">for</span> <span class="code-variable">t</span> <span class="code-keyword">in</span> <span class="code-variable">t_list</span><span class="code-colon">:</span>
        <span class="code-variable">s</span> <span class="code-operator">=</span> <span class="code-method">score</span><span class="code-brackets">(</span><span class="code-variable">q</span>, <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span><span class="code-brackets">)</span>
        <span class="code-variable">B_0</span><span class="code-punctuation">.</span><span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s</span><span class="code-punctuation">,</span> <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
    
    <span class="code-variable">B_0</span> <span class="code-operator">=</span> <span class="code-method">top</span><span class="code-brackets">(</span><span class="code-variable">B_0</span>, <span class="code-variable">b</span><span class="code-brackets">)</span>  <span class="code-comment"># Keep top b scoring triples</span>
    
    <span class="code-comment"># Iterative beam search</span>
    <span class="code-keyword">for</span> <span class="code-variable">i</span> <span class="code-keyword">in</span> <span class="code-builtin">range</span><span class="code-brackets">(</span><span class="code-number">1</span>, <span class="code-variable">l</span><span class="code-brackets">)</span>:
        <span class="code-variable">B</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>
        
        <span class="code-keyword">for</span> <span class="code-brackets">(</span><span class="code-variable">s</span>, <span class="code-variable">T</span><span class="code-brackets">)</span> <span class="code-keyword">in</span> <span class="code-variable">B_{i-1}</span>:
            <span class="code-variable">V</span> <span class="code-operator">=</span> <span class="code-brackets">[]</span>  <span class="code-comment"># Candidates from current path</span>
            
            <span class="code-comment"># Explore neighboring triples</span>
            <span class="code-keyword">for</span> <span class="code-variable">t</span> <span class="code-keyword">in</span> <span class="code-method">get_neighbours</span><span class="code-brackets">(</span><span class="code-variable">T</span><span class="code-brackets">[</span>-<span class="code-number">1</span><span class="code-brackets">]</span><span class="code-brackets">)</span>:
                <span class="code-comment"># Skip if triple already used</span>
                <span class="code-keyword">if</span> <span class="code-method">exists</span><span class="code-brackets">(</span><span class="code-variable">t</span><span class="code-punctuation">,</span> <span class="code-variable">B_{i-1}</span><span class="code-brackets">)</span><span class="code-colon">:</span>
                    <span class="code-keyword">continue</span>
                
                <span class="code-comment"># Score new path with concatenated triple</span>
                <span class="code-variable">new_path</span> <span class="code-operator">=</span> <span class="code-variable">T</span> <span class="code-operator">+</span> <span class="code-brackets">[</span><span class="code-variable">t</span><span class="code-brackets">]</span>
                <span class="code-variable">s_new</span> <span class="code-operator">=</span> <span class="code-variable">s</span> <span class="code-operator">+</span> <span class="code-method">score</span><span class="code-brackets">(</span><span class="code-variable">q</span><span class="code-punctuation">,</span> <span class="code-variable">new_path</span><span class="code-brackets">)</span>
                <span class="code-variable">V</span>.<span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s_new</span>, <span class="code-variable">new_path</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
            
            <span class="code-method">sort</span><span class="code-brackets">(</span><span class="code-variable">V</span><span class="code-punctuation">,</span> <span class="code-variable">descending</span><span class="code-operator">=</span><span class="code-builtin">True</span><span class="code-brackets">)</span>
            
            <span class="code-comment"># Apply diversity penalty</span>
            <span class="code-keyword">for</span> <span class="code-variable">n</span> <span class="code-keyword">in</span> <span class="code-builtin">range</span><span class="code-brackets">(</span><span class="code-method">len</span><span class="code-brackets">(</span><span class="code-variable">V</span><span class="code-brackets">)</span><span class="code-brackets">)</span>:
                <span class="code-variable">s_new</span><span class="code-punctuation">,</span> <span class="code-variable">path</span> <span class="code-operator">=</span> <span class="code-variable">V</span><span class="code-brackets">[</span><span class="code-variable">n</span><span class="code-brackets">]</span>
                <span class="code-variable">penalty</span> <span class="code-operator">=</span> <span class="code-builtin">exp</span><span class="code-brackets">(</span><span class="code-operator">-</span><span class="code-builtin">min</span><span class="code-brackets">(</span><span class="code-variable">n</span>, <span class="code-variable">γ</span><span class="code-brackets">)</span><span class="code-operator">/</span><span class="code-variable">γ</span><span class="code-brackets">)</span>
                <span class="code-variable">B</span><span class="code-punctuation">.</span><span class="code-method">add</span><span class="code-brackets">(</span><span class="code-brackets">(</span><span class="code-variable">s_new</span> <span class="code-operator">*</span> <span class="code-variable">penalty</span><span class="code-punctuation">,</span> <span class="code-variable">path</span><span class="code-brackets">)</span><span class="code-brackets">)</span>
        
        <span class="code-variable">B_i</span> <span class="code-operator">=</span> <span class="code-method">top</span><span class="code-brackets">(</span><span class="code-variable">B</span>, <span class="code-variable">b</span><span class="code-brackets">)</span>  <span class="code-comment"># Keep top b paths</span>
    
    <span class="code-keyword">return</span> <span class="code-variable">B_i</span></code></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!--BibTeX citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{shen2024gear,
  title={GeAR: Graph-enhanced Agent for Retrieval-augmented Generation},
  author={Shen, Zhili and Diao, Chenxin and Vougiouklis, Pavlos and Merita, Pascual and Piramanayagam, Shriram and Graux, Damien and Tu, Dandan and Jiang, Zeren and Lai, Ruofei and Ren, Yang and Pan, Jeff Z.},
  journal={arXiv preprint arXiv:2412.18431},
  year={2024}
}</code></pre>
    </div>
  </section>

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
              You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
              Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>
</html>